<div class="dashboard-shell">
  <!-- User Info -->
  <section class="user-info">
    @if (user) {
      <div class="user-header">
        <h3 class="welcome">üëã Welcome, {{ user.first_name }}</h3>

        <div class="public-id">
          <span>Public ID:</span>
          <code>{{ showPublicId ? user.public_id : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢' }}</code>
          <button (click)="togglePublicId()">
            {{ showPublicId ? 'üôà Hide' : 'üëÅ Show' }}
          </button>
          <button (click)="copyId()">
            {{ copied ? 'Copied!' : 'Copy' }}
          </button>
        </div>

        <button class="logout-btn" (click)="logout()">Logout</button>
      </div>
    }
  </section>

  <!-- Stats bar -->
  <section class="stats-bar">
    <div class="stat">
      <span>Total Value</span>
      <strong>${{ totalValue | number:'1.2-2' }}</strong>
    </div>
    <div class="stat" [ngClass]="{ positive: totalGains > 0, negative: totalGains < 0 }">
      <span>Gains</span>
      <strong>
        {{ totalGains >= 0 ? '+' : '' }}${{ totalGains | number:'1.2-2' }}
      </strong>
    </div>
    <div class="stat" [ngClass]="{ positive: totalLosses === 0, negative: totalLosses > 0 }">
      <span>Losses</span>
      <strong>-${{ totalLosses | number:'1.2-2' }}</strong>
    </div>
  </section>

  <!-- Main layout -->
  <section class="main-layout">
    <!-- Left: Chart + details -->
    <div class="chart-panel">
      @if (selectedStock) {
        <div class="stock-header">
          <img
            [src]="selectedStock.logo_url"
            alt="{{ selectedStock.symbol }}"
            class="stock-logo"
            (error)="$any($event.target).style.display='none'"
          />
          <div class="info">
            <h2>{{ selectedStock.symbol }}</h2>
            <p>{{ selectedStock.name }}</p>
          </div>
          <div class="price-block">
            <h2 [ngClass]="{ positive: selectedStock.change >= 0, negative: selectedStock.change < 0 }">
              ${{ selectedStock.price | number:'1.2-2' }}
            </h2>
            <p [ngClass]="{ positive: selectedStock.change >= 0, negative: selectedStock.change < 0 }">
              {{ selectedStock.change | number:'1.2-2' }}
              ({{ selectedStock.change_percent | percent:'1.1-1' }})
            </p>
          </div>
        </div>

        <div class="ohlc">
          <span>Open: {{ selectedStock.open }}</span>
          <span>High: {{ selectedStock.high }}</span>
          <span>Low: {{ selectedStock.low }}</span>
          <span>Close: {{ selectedStock.close }}</span>
        </div>
      }

      <canvas baseChart [data]="chartData" [options]="chartOptions" [type]="'line'"></canvas>
    </div>

    <!-- Right: Stock list -->
    <div class="list-panel">
      <app-stock-list (stockSelected)="onStockSelected($event)"></app-stock-list>
    </div>
  </section>
</div>
